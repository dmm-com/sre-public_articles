# サービスの稼働状況をStatus Pageを使って可視化した話

## はじめに
この記事は DMMグループ Advent Calendar 2023 のxx日目の記事です。

こんにちは、ITインフラ本部、SRE部です。
私たちSRE部では、DMMグループの各サービスの信頼性を横断的に向上させることをミッションに活動しております。

はやいものでもう年末ですね。毎年Advent Calendarの執筆依頼があると、もうそんな季節なのかと感じます。
今年の仕事の中からなにか面白い話を出せないかと思い色々考えたのですが、先日社内のサービスの稼働状態を可視化する仕組み（以下、Internal Status Page）を社内にリリースしましたので、まだ道半ばではありますが、その話を共有したいと思います。

## なぜ Internal Status Pageを作ろうと思ったのか
DMM.comグループでは現在60以上の事業を展開しており、数多くのサービスがシステムとして稼働しています。

各担当部門が、それぞれでシステムの監視やアラート対応などを行っており、運用のダッシュボードなどもそれぞれ作られています。

そのためサービス単体の運用に関しては、大きな問題はありません。

しかし、弊社の場合、社内共通の認証基盤や、会員系APIなどの共通系サービス以外でも、サービス間の依存関係などがあり、
自分の担当外のサービスの稼働状況を手早く知りたいといったケースが多々あります。

社内サービスのStatus Pageがあれば、これらのニーズに応えられるだろうと考えました。

## Internal Status Pageについて

### サービスの選定基準
自作する選択肢もあったかもしれないですが、今回はSaasが提供しているものを利用することにしました。Pagerdutyなど、いくつかの企業がInternal Status Pageを
実現するサービスを提供していますが、今回はAtlassianのStatuspageを利用することにしました。ページのカスタマイズができることなどが決め手になりました。

### システム構成

DMMでは、それぞれのサービスの監視にはDatadog, NewRelic, StatusCakeなどを利用しています。
これらのサービスから情報を集約し、Statuspageに反映させる仕組みを構築しました。 以下のようなイメージです。

![Internal Status Page](img/system_overview.png)

### 構成要素について

**Datadog / NewRelic:** サービスのパフォーマンス監視とアラート生成を担当します。問題を検知した際には即座にPagerDutyへアラートを送信します。（どのように？具体的な連携方法が記事になりそうならする？

**PagerDuty:** 監視ツールでのアラート状態をStatusPageに渡すためのハブ機能として利用します。

**StatusPage:** サービスの稼働状態を公開し、社員全員が確認できるように情報を提供します。障害発生時にはStatusPageが最新のステータスを表示し、現在の状況を把握できるようにします。


#### できた！

(スクリーンショットを貼る。テスト版でかまわない)

各サービスの稼働状況が俯瞰して見れるようになりました。各サービスの問い合わせ先などの情報も確認可能になっています。
社内のすべてのロールの方がグループ内のサービスの稼働状況をリアルタイムに確認できるようになったことは、不要な問い合わせを減らしたり、
Slackを探し回ることなどを減らすことができ、様々な場面で業務が効率化されると期待しています。

## 今後の展開

（基本的に、incident庭野さんにきいてまとめる）


### 現在と今後におけるアラート体系の強化

現在、PagerDutyを通じて最初の警告を行い、即座にStatusPageに情報を反映させる流れを確立しています。これにより、障害発生時の初動対応の迅速化を図っています。
今後、より詳細な分析と対応を目的とした通知体系を強化します。これにより、より深刻な問題や長期にわたる障害への対応を強化する計画です。

### インシデント管理プロセスの洗練

**インシデント対応:** ステータスページの役割を拡張し、インシデント管理機能を充実させることで、問題解決プロセスの透明性と効率を高めます。
**コミュニケーションの最適化:** Slackなどのコミュニケーションツールを活用し、インシデント発生時の社内コミュニケーションの流れを最適化します。これにより、関連する全てのチームが迅速に情報を共有し、協力して問題解決を行えるようにします。

### 監視と通知の精度向上

**メータリング:** システムの監視精度を向上させ、より精緻なデータに基づいたアラートを生成することで、予防的なメンテナンスと迅速な問題解決を実現します。
**通知のカスタマイズ:** 各チームのニーズに合わせたアラートのカスタマイズを進め、必要な情報だけが適切な人に届くようにします。

## 最後に
SRE部では共に仲間を募集しています！大規模なサービスや立ち上がったばかりの新事業など、様々な規模、ジャンル・フェーズが存在する環境でSREを実践しませんか？
Statuspageの取り組みなどはほんの一部で、SLO/SLIの設計や、共通ツールの開発など、多様な横断的な取り組みを行っています。カジュアル面談などお気軽にご連絡ください！

それでは皆様、よいお年を。




それでは皆さん良いクリスマスをお過ごしください〜



